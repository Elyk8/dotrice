#!/bin/sh
run() {
    if ! pgrep "$1" >/dev/null; then
        "$@" &
    fi
}

xrdb -merge ~/.config/x11/Xresources &
xrdbpid=$!

eval "$(gnome-keyring-daemon --start)"
export SSH_AUTH_SOCK

run kmonad-refresh &
run /usr/bin/emacs --daemon &
run /usr/bin/pipewire &
run pacmac-tray &
run sxhkd &
run nm-applet &
run dm-wacom &
run picom -b &
run clipmenud &
run redshift &
run lxsession &
run mpd &
run dunst-reload &
run "$HOME"/.fehbg &
xsetroot -cursor_name left_ptr

run syncthing-gtk --minimized

if [ "$(uname -n)" = "gpdskynet" ]; then
   xinput set-prop "pointer:Goodix Capacitive TouchScreen" --type=float "Coordinate Transformation Matrix" 0 1 0 -1 0 1 0 0 1
   xrandr -o right
   run unclutter --hide-on-touch
else
    run multi-monitor
fi

[ -n "$xrdbpid" ] && wait "$xrdbpid"
