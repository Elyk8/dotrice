#!/bin/sh

run() {
    if ! pgrep "$1" > /dev/null ;
    then
        "$@"&
    fi
}

# /usr/bin/prime-offload
# multi-monitor
multi-hybrid-graphics
xrdb -merge ~/.config/x11/Xresources & xrdbpid=$!
run safeeyes -e &
run kmonad-refresh &
run /usr/bin/emacs --daemon &
run syncthing-gtk --minimized &
run /usr/bin/pipewire &
run pacmac-tray &

autostart="redshift clipmenud flashfocus dunst lxsession nm-applet picom mpd musnify-mpd"
for program in $autostart; do
    pidof -s "$program" || setsid -f "$program"
done >/dev/null 2>&1

run "$HOME"/.fehbg &
sleep 5 && run volctl && mictray &

[ -n "$xrdbpid" ] && wait "$xrdbpid"
